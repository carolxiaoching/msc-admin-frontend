import{b as U,f as $}from"./api-BuVyP45F.js";import{l as C,m as V,r as m,z as R,c,a as e,b as h,F as k,S,w as x,d as T,T as z,o as r,t as l,W as w,f as _,e as B}from"./index-DLEIqx4g.js";import{_ as L,a as A}from"./DelModal-DSvRl_CF.js";const F={class:"table-responsive"},j={class:"table mb-14 align-middle"},E={class:"d-none d-md-table-cell text-center"},G={class:"text-center"},P={class:"d-flex justify-content-center align-items-center"},W={key:0,class:"thumbnail me-4 rounded-circle"},q={key:1,class:"thumbnail me-4 rounded-circle"},H={class:"d-none d-lg-table-cell text-center"},J={class:"d-none d-xxl-table-cell text-center"},K={class:"d-none d-sm-table-cell text-center"},O={class:"d-none d-xxl-table-cell text-center"},Q={class:"d-none d-xxl-table-cell text-center"},X={class:"text-center"},Y={class:"btn-group btn-group-sm",role:"group"},Z=["onClick"],ee={class:"mb-8"},te={class:"d-flex align-items-center"},se={key:0,class:"thumbnail me-4 rounded-circle"},de={__name:"MembersView",setup(ae){const M=C(),I=V(),{openLoading:v,closeLoading:i}=M,{pushMessage:u}=I,p=m([]),f=m({}),b=m(null),o=m({id:"",role:"",avatarImgUrl:"",nickName:""});async function g(a=1){var t,d;v();try{const n=await U({page:a});p.value=n.data.data.results,f.value=n.data.data.pagination,i()}catch(n){u({style:"danger",title:"載入失敗",text:((d=(t=n.response)==null?void 0:t.data)==null?void 0:d.message)||"載入失敗，請重整網頁"}),i()}}async function N(a){var t,d,n;v();try{const s=await $(a),{status:y}=s.data;y==="success"?(u({style:"success",title:"刪除成功",text:"刪除成功，請等待載入畫面"}),g()):u({style:"danger",title:"刪除失敗",text:"刪除失敗，請重整網頁"}),(t=b.value)==null||t.hideModal(),i()}catch(s){u({style:"danger",title:"刪除失敗",text:((n=(d=s.response)==null?void 0:d.data)==null?void 0:n.message)||"刪除失敗，請重整網頁"}),i()}}function D(a){var t;o.value={id:a._id,role:a.role,avatarImgUrl:a.avatarImgUrl,nickName:a.nickName},(t=b.value)==null||t.openModal()}return R(()=>{g()}),(a,t)=>{const d=T("router-link"),n=z("lazy");return r(),c(k,null,[t[4]||(t[4]=e("h1",{class:"mb-14 h3"},"會員管理",-1)),e("div",F,[e("table",j,[t[2]||(t[2]=e("thead",null,[e("tr",{class:"table-active"},[e("th",{class:"d-none d-md-table-cell text-center",width:"120"},"ID 編號"),e("th",{class:"text-center"},"會員"),e("th",{class:"d-none d-lg-table-cell text-center"},"電子信箱"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"120"},"性別"),e("th",{class:"d-none d-sm-table-cell text-center",width:"120"},"身分別"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"建立時間"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"更新時間"),e("th",{class:"text-center",width:"200"},"編輯")])],-1)),e("tbody",null,[(r(!0),c(k,null,S(p.value,s=>(r(),c("tr",{key:s._id},[e("td",E,"#"+l(s._id.slice(-5)),1),e("td",G,[e("div",P,[s.avatarImgUrl?w((r(),c("img",W,null,512)),[[n,s.avatarImgUrl]]):(r(),c("div",q,t[0]||(t[0]=[e("i",{class:"bi bi-person-fill"},null,-1)]))),_(" "+l(s.nickName),1)])]),e("td",H,l(s.email),1),e("td",J,l({female:"女生",male:"男性"}[s.gender]||"秘密"),1),e("td",K,l(s.role==="admin"?"管理員":"會員"),1),e("td",O,l(a.$getTime(s.createdAt)),1),e("td",Q,l(a.$getTime(s.updatedAt)),1),e("td",X,[e("div",Y,[h(d,{to:`/dashboard/member/${s._id}`,class:"btn btn-outline-dark"},{default:x(()=>t[1]||(t[1]=[_(" 編輯 ")])),_:2},1032,["to"]),e("button",{type:"button",class:"btn btn-outline-danger",onClick:y=>D(s)}," 刪除 ",8,Z)])])]))),128))])])]),h(L,{pagination:f.value,onUpdatePage:g},null,8,["pagination"]),h(A,{ref_key:"delModalRef",ref:b,"del-id":o.value.id,onDelItem:N},{"modal-header":x(()=>[_(" 刪除"+l(o.value.role==="admin"?"管理員":"會員"),1)]),"modal-content":x(()=>[e("p",ee,[t[3]||(t[3]=_(" 確定要刪除 ")),e("strong",null,l(o.value.role==="admin"?"管理員":"會員")+"：#"+l(o.value.id.slice(-5)),1)]),e("div",te,[o.value.avatarImgUrl?w((r(),c("img",se,null,512)),[[n,o.value.avatarImgUrl]]):B("",!0),e("strong",null,l(o.value.nickName),1)])]),_:1},8,["del-id"])],64)}}};export{de as default};
