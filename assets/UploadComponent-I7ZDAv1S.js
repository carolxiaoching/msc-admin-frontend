import{l as S,m as B,r as u,c as o,o as l,a,A as b,a3 as v,n as f,f as F,t as y,F as j}from"./index-NowiT2I7.js";import{p as D}from"./api-BRBvrrQh.js";const P={key:0},$={class:"text-center"},z={key:1},M={key:1,class:"uploadLabelBtn cursorPoint d-flex flex-column justify-content-center align-items-center fs-5"},N={for:"image",class:"d-block text-center"},O={class:"btn btn-primary w-75"},E={__name:"UploadComponent",props:{tempImageUrl:{type:String,default:""},imageType:{type:String,default:"avatar"}},emits:["updateImage"],setup(t,{emit:w}){const k=S(),x=B(),{openLoading:I,closeLoading:g}=k,{pushMessage:r}=x,U=t,h=w,i=u(""),c=u(!1),m=u("");function C(s){const e=s.target.files[0];if(e){i.value=e;let n=window.URL.createObjectURL(e);c.value=!0,m.value=n}}function p(){i.value="",m.value="",c.value=!1,window.URL.revokeObjectURL(i.value)}async function L(){var e,n;const s=new FormData;s.append("image",i.value),I();try{const d=await D(s,U.imageType),{status:R,data:T}=d.data;R==="success"?(r({style:"success",title:"上傳成功",text:"上傳成功，請等待圖片載入"}),h("updateImage",T.imageUrl)):r({style:"danger",title:"上傳失敗",text:"上傳失敗，請重整網頁"}),p(),g()}catch(d){r({style:"danger",title:"上傳失敗",text:((n=(e=d.response)==null?void 0:e.data)==null?void 0:n.message)||"上傳失敗，請重整網頁"}),g()}}return(s,e)=>(l(),o(j,null,[a("input",{type:"file",accept:"image/*",id:"image",name:"image",class:"d-none",onChange:C},null,32),c.value?(l(),o("div",P,[a("div",{class:f(["position-relative mb-11 border rounded-3",[t.imageType==="icon"?"":"mb-lg-17"]])},[a("a",{href:"#",class:"previewResetBtn position-absolute top-0 end-0 px-2 text-white fs-2",onClick:e[0]||(e[0]=b(n=>p(),["prevent"]))},e[1]||(e[1]=[a("i",{class:"bi bi-x"},null,-1)])),a("div",{class:"previewImage backgroundCover rounded-3",style:v({backgroundImage:`url(${m.value})`})},null,4)],2),a("div",$,[a("button",{type:"button",class:"btn btn-primary w-75",onClick:b(L,["prevent"])}," 確認更新 ")])])):(l(),o("div",z,[a("label",{for:"image",class:f(["w-100 mb-11 border rounded-3 overflow-hidden",[t.imageType==="icon"?"":"mb-xl-17"]])},[t.tempImageUrl?(l(),o("span",{key:0,class:"uploadLabelImage backgroundCover cursorPoint d-block",style:v({backgroundImage:`url(${t.tempImageUrl})`})},null,4)):(l(),o("span",M,[e[2]||(e[2]=a("i",{class:"bi bi-cloud-arrow-up d-block display-3"},null,-1)),F(" 點擊上傳"+y(t.imageType==="avatar"?"頭像":"封面"),1)]))],2),a("label",N,[a("span",O,y(t.imageType==="avatar"?"更新頭像":"更新封面"),1)])]))],64))}};export{E as _};
