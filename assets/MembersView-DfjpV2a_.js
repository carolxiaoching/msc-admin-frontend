import{b as U,f as D}from"./api-tKCg3TZ9.js";import{l as $,m as C,r as m,z as R,c as d,a as e,b as h,F as k,S,w as x,d as V,o as c,t as a,f as _}from"./index-CIIQbgs8.js";import{_ as B,a as L}from"./DelModal-DsZnU4wa.js";const T={class:"table-responsive"},A={class:"table mb-14 align-middle"},F={class:"d-none d-md-table-cell text-center"},j={class:"text-center"},z={class:"d-flex justify-content-center align-items-center"},E=["src"],G={key:1,class:"thumbnail me-4 rounded-circle"},P={class:"d-none d-lg-table-cell text-center"},q={class:"d-none d-xxl-table-cell text-center"},H={class:"d-none d-sm-table-cell text-center"},J={class:"d-none d-xxl-table-cell text-center"},K={class:"d-none d-xxl-table-cell text-center"},O={class:"text-center"},Q={class:"btn-group btn-group-sm",role:"group"},W=["onClick"],X={class:"mb-8"},Y={class:"d-flex align-items-center"},Z=["src"],ee={key:1,src:"",class:"thumbnail me-4 rounded-circle"},ne={__name:"MembersView",setup(te){const y=$(),M=C(),{openLoading:p,closeLoading:r}=y,{pushMessage:i}=M,v=m([]),f=m({}),b=m(null),n=m({id:"",role:"",avatarImgUrl:"",nickName:""});async function g(l=1){var s,o;p();try{const t=await U({page:l});v.value=t.data.data.results,f.value=t.data.data.pagination,r()}catch(t){i({style:"danger",title:"載入失敗",text:((o=(s=t.response)==null?void 0:s.data)==null?void 0:o.message)||"載入失敗，請重整網頁"}),r()}}async function w(l){var s,o,t;p();try{const u=await D(l),{status:N}=u.data;N==="success"?(i({style:"success",title:"刪除成功",text:"刪除成功，請等待載入畫面"}),g()):i({style:"danger",title:"刪除失敗",text:"刪除失敗，請重整網頁"}),(s=b.value)==null||s.hideModal(),r()}catch(u){i({style:"danger",title:"刪除失敗",text:((t=(o=u.response)==null?void 0:o.data)==null?void 0:t.message)||"刪除失敗，請重整網頁"}),r()}}function I(l){var s;n.value={id:l._id,role:l.role,avatarImgUrl:l.avatarImgUrl,nickName:l.nickName},(s=b.value)==null||s.openModal()}return R(()=>{g()}),(l,s)=>{const o=V("router-link");return c(),d(k,null,[s[4]||(s[4]=e("h1",{class:"mb-14 h3"},"會員管理",-1)),e("div",T,[e("table",A,[s[2]||(s[2]=e("thead",null,[e("tr",{class:"table-active"},[e("th",{class:"d-none d-md-table-cell text-center",width:"120"},"ID 編號"),e("th",{class:"text-center"},"會員"),e("th",{class:"d-none d-lg-table-cell text-center"},"電子信箱"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"120"},"性別"),e("th",{class:"d-none d-sm-table-cell text-center",width:"120"},"身分別"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"建立時間"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"更新時間"),e("th",{class:"text-center",width:"200"},"編輯")])],-1)),e("tbody",null,[(c(!0),d(k,null,S(v.value,t=>(c(),d("tr",{key:t._id},[e("td",F,"#"+a(t._id.slice(-5)),1),e("td",j,[e("div",z,[t.avatarImgUrl?(c(),d("img",{key:0,src:t.avatarImgUrl,class:"thumbnail me-4 rounded-circle"},null,8,E)):(c(),d("div",G,s[0]||(s[0]=[e("i",{class:"bi bi-person-fill"},null,-1)]))),_(" "+a(t.nickName),1)])]),e("td",P,a(t.email),1),e("td",q,a({female:"女生",male:"男性"}[t.gender]||"秘密"),1),e("td",H,a(t.role==="admin"?"管理員":"會員"),1),e("td",J,a(l.$getTime(t.createdAt)),1),e("td",K,a(l.$getTime(t.updatedAt)),1),e("td",O,[e("div",Q,[h(o,{to:`/dashboard/member/${t._id}`,class:"btn btn-outline-dark"},{default:x(()=>s[1]||(s[1]=[_(" 編輯 ")])),_:2},1032,["to"]),e("button",{type:"button",class:"btn btn-outline-danger",onClick:u=>I(t)}," 刪除 ",8,W)])])]))),128))])])]),h(B,{pagination:f.value,onUpdatePage:g},null,8,["pagination"]),h(L,{ref_key:"delModalRef",ref:b,"del-id":n.value.id,onDelItem:w},{"modal-header":x(()=>[_(" 刪除"+a(n.value.role==="admin"?"管理員":"會員"),1)]),"modal-content":x(()=>[e("p",X,[s[3]||(s[3]=_(" 確定要刪除 ")),e("strong",null,a(n.value.role==="admin"?"管理員":"會員")+"：#"+a(n.value.id.slice(-5)),1)]),e("div",Y,[n.value.avatarImgUrl?(c(),d("img",{key:0,src:n.value.avatarImgUrl,class:"thumbnail me-4 rounded-circle"},null,8,Z)):(c(),d("img",ee)),e("strong",null,a(n.value.nickName),1)])]),_:1},8,["del-id"])],64)}}};export{ne as default};
